{% extends 'base.html' %}
{% block readStoryContainer %}
<div class="user-view-profile">
    {% for u in user %}
        <div class="user-profile-data">
            <p class="user-name">{{ u.name }} {{ u.lastname }}</p>
            <p class="user-email">{{ u.user_email }}</p>
            {% if user.description %}
            <p class="user-email">{{ u.description }}</p>
            {% endif %}
            <div class="user-profile-followers">
                <p class="user-follow"><span>{{ u.following|length }}</span> following</p>
                <p class="user-follow"><span>{{ u.followers|length }}</span> followers</p>
            </div>
            {% if nickname != u.user_email %}
                {% if not following %}
                    <form action="/follow?user={{ u.user_email }}" method="post">
                        <input type="submit" name="follow" id="follow-button" value="Follow">
                    </form>
                {% else %}
                    <form action="/unfollow?user={{ u.user_email }}" method="post">
                        <input type="submit" name="unfollow" id="unfollow-button" value="Following">
                    </form>
                {% endif %}
            {% endif %}
        </div>
        {% if u.avatar %}
            <div class="user-profile-image">
                <img src='data:image/png;base64, {{ u.avatar.encode("base64") }}' class="img-circle" alt="Profile avatar">
            </div>
        {% endif %}
        </div>
        <ul class="nav nav-pills">
            <li class="active">
                <a  href="#1a" data-toggle="tab">Likes</a>
            </li>
            <li>
                <a href="#2a" data-toggle="tab">Stories</a>
            </li>
            <li>
                <a href="#3a" data-toggle="tab">Bookmarked</a>
            </li>
        </ul>
        <div class="tab-content clearfix">
            <div class="tab-pane active" id="1a">
                {% if likes %}
                    {% for l in likes %}
                    <div class="card-with-image">
                        <div class="card-block">
                            <div class="card-header">
                                <a class="card-user" href="/profile?user={{ l.author }}">{{ l.author }}</a>
                                <p class="card-date">{{ l.date }}</p>
                            </div>
                            {% if l.image %}
                            <div class="card-image-container">
                                <img src='data:image/png;base64, {{ l.image.encode("base64") }}' class="image-responsive" alt="">
                            </div>
                            {% endif %}
                            <a class="card-title" href="/read_story?id={{ l.key.urlsafe() }}">{{ l.title }}</a>
                            <!--Text-->
                            <p class="card-text">{{ l.text }}</p>
                            <div class="card-btns">
                                <a href="/read_story?id={{ l.key.urlsafe() }}" class="btn-read-more">Read more...</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                <span class="empty-contianer">You don't like any story yet</span>
                {% endif %}
            </div>
            <div class="tab-pane" id="2a">
                {% if stories %}
                    {% for s in stories %}
                    <div class="card-with-image">
                        <div class="card-block">
                            <div class="card-header">
                                <a class="card-user" href="/profile?user={{ s.author }}">{{ s.author }}</a>
                                <p class="card-date">{{ s.date }}</p>
                            </div>
                            {% if s.image %}
                            <div class="card-image-container">
                                <img src='data:image/png;base64, {{ s.image.encode("base64") }}' class="image-responsive" alt="">
                            </div>
                            {% endif %}
                            <a class="card-title" href="/read_story?id={{ s.key.urlsafe() }}">{{ s.title }}</a>
                            <!--Text-->
                            <p class="card-text">{{ s.text }}</p>
                            <div class="card-btns">
                                <a href="/read_story?id={{ s.key.urlsafe() }}" class="btn-read-more">Read more...</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <span class="empty-contianer"><a href="write_story.html">Write</a> a story !</span>
                {% endif %}
            </div>
            <div class="tab-pane" id="3a">
                {% if bookmarks %}
                {% for s in bookmarks %}
                <div class="card-with-image">
                    <div class="card-block">
                        <div class="card-header">
                            <a class="card-user" href="/profile?user={{ s.author }}">{{ s.author }}</a>
                            <p class="card-date">{{ s.date }}</p>
                        </div>
                        {% if s.image %}
                        <div class="card-image-container">
                            <img src='data:image/png;base64, {{ s.image.encode("base64") }}' class="image-responsive" alt="">
                        </div>
                        {% endif %}
                        <a class="card-title" href="/read_story?id={{ s.key.urlsafe() }}">{{ s.title }}</a>
                        <!--Text-->
                        <p class="card-text">{{ s.text }}</p>
                        <div class="card-btns">
                            <a href="/read_story?id={{ s.key.urlsafe() }}" class="btn-read-more">Read more...</a>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                    <span class="empty-contianer"></span>
                {% endif %}
            </div>
        </div>
    {% endfor %}
{% endblock %}
